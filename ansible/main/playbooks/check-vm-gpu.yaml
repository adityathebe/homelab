---
- name: Check GPU status on worker nodes
  hosts: nodes
  become: true
  gather_facts: true

  roles:
    - gpu-check

  post_tasks:
    - name: Summary of GPU status across all nodes
      debug:
        msg:
          - '=== GPU Status Summary ==='
          - 'Node: {{ inventory_hostname }}'
          - 'Has GPU: {{ has_gpu }}'
          - 'GPU Count: {{ gpu_devices | length }}'
      when: has_gpu is defined
